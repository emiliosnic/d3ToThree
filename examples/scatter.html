<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>D3to3</title>
	<meta name="description" content="D3to3">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

	<!-- Styles -->
	<link rel="stylesheet" href="../assets/reset.css">
	<link rel="stylesheet" href="../assets/style.css">
	<link rel="stylesheet" href="../assets/style.css">

</head>
<body>
	
	<br>
	<img src="../assets/mvc.png" width="500"/>

	<script src="../lib/d3.js"></script>
	<script src="../lib/three.min.js"></script>
	<script src="../dist/d3to3.js"></script>
	<ul class="panels">
		<li>
			<h2>D3</h2>
			<div id="d3_panel">
		</li>
		<li>
			<h2>D3to3</h2>
			<div id="d3to3_panel"></div>
		</li>
	</ul>

	<script type="text/javascript">

		var margin = {top: 20, right: 20, bottom: 30, left: 40},
			width  = 550 - margin.left - margin.right,
			height = 250 - margin.top  - margin.bottom;

		var nodes = [
			{'Name': 'Node 1', 'Category': 'A', 'Calories':10 , 'Protein (g)':4, 'radius': 8  },
			{'Name': 'Node 2', 'Category': 'A', 'Calories':20 , 'Protein (g)':6, 'radius': 9  },
			{'Name': 'Node 3', 'Category': 'B', 'Calories':30 , 'Protein (g)':2, 'radius': 8  },
			{'Name': 'Node 4', 'Category': 'B', 'Calories':40 , 'Protein (g)':2, 'radius': 16  },
			{'Name': 'Node 5', 'Category': 'A', 'Calories':60 , 'Protein (g)':3, 'radius': 11 },
			{'Name': 'Node 6', 'Category': 'A', 'Calories':80 , 'Protein (g)':8, 'radius': 10  },
			{'Name': 'Node 7', 'Category': 'C', 'Calories':63 , 'Protein (g)':7, 'radius': 20 },
			{'Name': 'Node 8', 'Category': 'C', 'Calories':69 , 'Protein (g)':10, 'radius': 12 },
			{'Name': 'Node 9', 'Category': 'A', 'Calories':30 , 'Protein (g)':8, 'radius': 12 }
		];
		nodes.forEach(function(d) {
			d.Calories = +d.Calories;
			d["Protein (g)"] = +d["Protein (g)"];
		});

		// Setup x-Axis values
		var xScale = d3.scale.linear().range([0, width]), 
			xValue = function(d) { return d.Calories;        },
			xMap   = function(d) { return xScale(xValue(d)); }, 
			xAxis  = d3.svg.axis().scale(xScale).orient("bottom");
		
		
		// Setup y-Axis values
		var yScale = d3.scale.linear().range([height, 0]), 
			yValue = function(d) { return d["Protein (g)"];  }, 
			yMap   = function(d) { return yScale(yValue(d)); }, 
			yAxis  = d3.svg.axis().scale(yScale).orient("left");

		// Setup radius values
		var rMap   = function(d) { return d["radius"]; };

		// Setup Fill Color
		var color = d3.scale.category10(),
			cValue = function(d) { return d.Category; };
	

		// Append the graph
		var svg = d3.select("#d3_panel")
			.append("svg")
			.attr("width", width + margin.left + margin.right)
			.attr("height", height + margin.top + margin.bottom)
			.append("g")
			.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
		xScale.domain([d3.min(nodes, xValue)-1, d3.max(nodes, xValue)+1]);
		yScale.domain([d3.min(nodes, yValue)-1, d3.max(nodes, yValue)+1]);

		// X Axis
		svg.append("g")	
			.attr("class", "x axis")
			.call(xAxis)
			.d3to3().axis();

		// Y Axis
		svg.append("g")
			.attr("class", "y axis")
			.call(yAxis)
			.d3to3().axis();

		// Draw Circles
		svg.selectAll()
			.data(nodes)
			.enter().append("circle")
			.attr("r", rMap)
			.attr("cx", xMap)
			.attr("cy", yMap)
			.style("fill", function(d) { return color(cValue(d));})
			.d3to3().data();

		d3to3.render({
			'source': 'd3_panel',
			'target': 'd3to3_panel'
		})

	</script>

</body>
</html>