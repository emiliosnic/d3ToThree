<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
  <!-- Example based on http://bl.ocks.org/mbostock/3887118 -->
  <!-- Tooltip example from http://www.d3noob.org/2013/01/adding-tooltips-to-d3js-graph.html -->

  <style>
  body {
    font: 11px sans-serif;
  }
  .axis path,
  .axis line {
    fill: none;
    stroke: #000;
    shape-rendering: crispEdges;
  }
  .dot {
    stroke: #000;
  }
  .tooltip {
    position: absolute;
    width: 200px;
    height: 28px;
    pointer-events: none;
  }
  .panels {
    display: block;
    width:100%;
    height: auto;
    overflow: auto;
  }
  .panels li {
    display: block;
    width: 50%;
    height: auto;
    overflow: auto;
    float: left;
    text-align: center;
  }
  a.cta {
    background: green;
    padding:20px; 
    display: inline-block;
    text-decoration: none;
    color: white;
    font-size: 1.4em;
    cursor: pointer;
    cursor: hand;
  }

  </style>
  
</head>
<body>

<script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>

<script src="lib/d3.js"></script>
<script src="lib/three.min.js"></script>
<script src="dist/d3to3.min.js"></script>

  <ul class="panels">
    <li id="d3_panel"></li>
    <li id="custom_panel"></li>
  </ul>

  <script>



  var margin = {top: 20, right: 20, bottom: 30, left: 40},
      width = 600 - margin.left - margin.right,
      height = 300 - margin.top - margin.bottom;
  var d3_data = [
    {'Ceral Name': 'Aristote', 'Manufacturer': 'Quaker', 'Type': 'A', 'Calories':10 , 'Protein (g)':4 },
    {'Ceral Name': 'Platonas', 'Manufacturer': 'Quaker', 'Type': 'B', 'Calories':20 , 'Protein (g)':6 },
    {'Ceral Name': 'Parmenidis', 'Manufacturer': 'FFGreat', 'Type': 'C', 'Calories':30 , 'Protein (g)':2 },
    {'Ceral Name': 'Fidias', 'Manufacturer': 'FFGreat', 'Type': 'A', 'Calories':46, 'Protein (g)':1 },
    {'Ceral Name': 'YesTest', 'Manufacturer': 'Quaker', 'Type': 'B', 'Calories':67 , 'Protein (g)':3 },
    {'Ceral Name': 'Something Here', 'Manufacturer': 'Quaker', 'Type': 'C', 'Calories':83 , 'Protein (g)':8 },
    {'Ceral Name': 'asdgasd', 'Manufacturer': 'Yolo', 'Type': 'A', 'Calories':63, 'Protein (g)':7 },
    {'Ceral Name': 'dhaesTest', 'Manufacturer': 'Yolo', 'Type': 'B', 'Calories':69 , 'Protein (g)':9 },
    {'Ceral Name': 'asdga Here', 'Manufacturer': 'Quaker', 'Type': 'C', 'Calories':30 , 'Protein (g)':8 }
  ];
  /* 
   * value accessor - returns the value to encode for a given data object.
   * scale - maps value to a visual display encoding, such as a pixel position.
   * map function - maps from data value to display value
   * axis - sets up axis
   */ 
  // setup x 
  var xValue = function(d) { return d.Calories;}, // data -> value
      xScale = d3to3.scale.linear().range([0, width]), // value -> display
      xMap = function(d) { return xScale(xValue(d));}, // data -> display
      xAxis = d3to3.svg.axis().scale(xScale).orient("bottom");
  // setup y
  var yValue = function(d) { return d["Protein (g)"];}, // data -> value
      yScale = d3to3.scale.linear().range([height, 0]), // value -> display
      yMap = function(d) { return yScale(yValue(d));}, // data -> display
      yAxis = d3to3.svg.axis().scale(yScale).orient("left");
  // setup fill color
  var cValue = function(d) { return d.Manufacturer;},
      color = d3to3.scale.category10();
  // add the graph canvas to the body of the webpage
  var svg = d3to3.select("#d3_panel").append("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  // add the tooltip area to the webpage
  var tooltip = d3to3.select("body").append("div")
      .attr("class", "tooltip")
      .style("opacity", 0);
  // load data
    // change string (from CSV) into number format
    d3_data.forEach(function(d) {
      d.Calories = +d.Calories;
      d["Protein (g)"] = +d["Protein (g)"];
    });
    // don't want dots overlapping axis, so add in buffer to d3_data domain
    xScale.domain([d3to3.min(d3_data, xValue)-1, d3to3.max(d3_data, xValue)+1]);
    yScale.domain([d3to3.min(d3_data, yValue)-1, d3to3.max(d3_data, yValue)+1]);
/*    // x-axis
    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis)
      .append("text")
        .attr("class", "label")
        .attr("x", width)
        .attr("y", -6)
        .style("text-anchor", "end");
    // y-axis
    svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)
      .append("text")
        .attr("class", "label")
        .attr("transform", "rotate(-90)")
        .attr("y", 6)
        .attr("dy", ".71em")
        .style("text-anchor", "end");
*/
    // draw dots
    svg.selectAll(".dot")
        .data(d3_data)
      .enter().append("circle")
        .attr("class", "dot")
        .attr("r", 8)
        .attr("cx", xMap)
        .attr("cy", yMap)
        .style("fill", function(d) { return color(cValue(d));}) 
        .on("mouseover", function(d) {
            tooltip.transition()
                 .duration(200)
                 .style("opacity", .9);
            tooltip.html(d["Cereal Name"] + "<br/> (" + xValue(d) 
  	        + ", " + yValue(d) + ")")
                 .style("left", (d3to3.event.pageX + 5) + "px")
                 .style("top", (d3to3.event.pageY - 28) + "px");
        })
        .on("mouseout", function(d) {
            tooltip.transition()
                 .duration(500)
                 .style("opacity", 0);
        });
d3to3.to3D("#d3_panel");

  </script>

  </body>
  </html>